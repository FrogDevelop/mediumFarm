import{TonConnect as tt}from"https://cdn.jsdelivr.net/npm/@tonconnect/sdk@latest/+esm";class et{constructor(){this.connector=new tt({manifestUrl:"https://your-site.com/tonconnect-manifest.json"}),this.account=null}async connect(){try{if(this.connector.connected)return this.account=this.connector.account,this.account;const e=await this.connector.getWallets();if(!e.length)throw new Error("No wallets available");const n=this.connector.connect(e[0]);return window.open(n,"_blank"),new Promise(o=>{this.connector.onStatusChange(i=>{i&&(this.account=i,o(i))})})}catch(e){throw console.error("Connection error:",e),e}}async getBalance(){if(!this.account)throw new Error("Wallet not connected");return"100.00"}}var Z;const $=(Z=window.Telegram)==null?void 0:Z.WebApp;function nt(t){return t>=1e3?"Legend":t>=500?"Veteran":t>=200?"Experienced":t>=100?"Intermediate":t>=50?"Beginner":"Newbie"}function ot(t){return"zip_shishka.png"}$&&($.isExpanded||$.expand(),document.documentElement.style.height=`${$.viewportHeight}px`,document.body.style.height=`${$.viewportHeight}px`);let p=parseInt(localStorage.getItem("darknetReputation"))||0;localStorage.getItem("darknetUnlocked");let b=parseInt(localStorage.getItem("playerMoney"))||500;parseInt(localStorage.getItem("shishCount"));let c=JSON.parse(localStorage.getItem("inventory"))||{},_,R=!1,N=!1,P=!1,O=!1;const q={},D=document.querySelector(".money"),J=[{id:"zip",name:"–ó–∏–ø –ø–∞–∫–µ—Ç",price:5,type:"zip",image:"zip.png",description:"–ü–ª–æ—Ç–Ω—ã–π –ø–∞–∫–µ—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —à–∏—à–µ–∫.",displayName:"–∑–∏–ø-–ø–∞–∫–µ—Ç–æ–≤",quantitySelectable:!0},{id:"fertilizer",name:"–£–¥–æ–±—Ä–µ–Ω–∏–µ",price:500,type:"fertilizer",image:"fertilizer.png",description:"–û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–µ —É–¥–æ–±—Ä–µ–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–æ—Å—Ç–∞ –∫—É—Å—Ç–æ–≤.",displayName:"—É–¥–æ–±—Ä–µ–Ω–∏–π",quantitySelectable:!0},{id:"plant_food",name:"–ï–¥–∞ –¥–ª—è –∫—É—Å—Ç–∞",price:400,type:"plant_food",image:"plant_food.png",description:"–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –¥–ª—è —Ä–∞—Å—Ç–µ–Ω–∏—è.",displayName:"–µ–¥—ã –¥–ª—è –∫—É—Å—Ç–∞",quantitySelectable:!0},{id:"super_food",name:"–°—É–ø–µ—Ä-–ø–∏—Ç–∞–Ω–∏–µ",price:3e3,type:"super_food",image:"super_food.png",description:"–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –¥–æ–±–∞–≤–∫–∞ –¥–ª—è —Ä–∞—Å—Ç–µ–Ω–∏–π.",displayName:"—Å—É–ø–µ—Ä-–ø–∏—Ç–∞–Ω–∏–π",quantitySelectable:!0},{id:"rare_fertilizer",name:"–†–µ–¥–∫–∏–π —É–¥–æ–±—Ä–∏—Ç–µ–ª—å",price:300,type:"rare_fertilizer",image:"rare_fertilizer.png",description:"–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞.",displayName:"—Ä–µ–¥–∫–∏—Ö —É–¥–æ–±—Ä–∏—Ç–µ–ª–µ–π",quantitySelectable:!0}],it={growthBoost:{name:"–£—Å–∫–æ—Ä–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç",icon:"fertilizer.png",duration:120,description:"–†–∞—Å—Ç–µ–Ω–∏—è —Ä–∞—Å—Ç—É—Ç –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ",activate:function(){R=!0}},yieldBoost:{name:"–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —É—Ä–æ–∂–∞–π",icon:"plant_food.png",duration:60,description:"+1 —à–∏—à–∫–∞ –∑–∞ —Å–±–æ—Ä (–≤—Å–µ–≥–¥–∞)",activate:function(){N=!0}},rareHarvest:{name:"–†–µ–¥–∫–∏–π —É—Ä–æ–∂–∞–π",icon:"rare_fertilizer.png",duration:120,description:"50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å +1 —à–∏—à–∫—É",activate:function(){P=!0}},superFood:{name:"–°—É–ø–µ—Ä –ø–∏—Ç–∞–Ω–∏–µ",icon:"super_food.png",duration:30,description:"10% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å 5 —à–∏—à–µ–∫ –≤–º–µ—Å—Ç–æ 1",activate:function(){O=!0}}};function u(t,e=!1){let n=document.getElementById("notification-container");n||(n=document.createElement("div"),n.id="notification-container",document.body.appendChild(n));const o=document.createElement("div");o.className=`notification ${e?"error":""}`,o.textContent=t,n.appendChild(o),setTimeout(()=>{o.style.opacity="1",o.style.animation="slideInFromLeft 0.3s ease-out forwards"},10),setTimeout(()=>{o.style.animation="fadeOutToLeft 0.3s ease-in forwards",setTimeout(()=>o.remove(),300)},1e3)}function at(t){if(Object.keys(q).length>=1)return u("–ú–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–∞—Ñ—Ñ –∑–∞ —Ä–∞–∑!",!0),!1;const e=it[t];if(!e)return!1;const n=document.getElementById("buff-status-container");if(!n)return!1;const o=document.createElement("div");o.className="buff-item",o.id=`buff-${t}`,o.innerHTML=`
        <img src="${e.icon}" alt="${e.name}" class="buff-icon">
        <div class="buff-timer">${Math.floor(e.duration/60)}:${(e.duration%60).toString().padStart(2,"0")}</div>
    `,n.appendChild(o);const i=Date.now()+e.duration*1e3;function a(){const d=Math.max(0,Math.floor((i-Date.now())/1e3)),v=String(Math.floor(d/60)).padStart(2,"0"),M=String(d%60).padStart(2,"0");o.querySelector(".buff-timer").textContent=`${v}:${M}`,d<=0&&(clearInterval(l),o.remove(),delete q[t],st(t),u(`–ë–∞—Ñ—Ñ "${e.name}" –∑–∞–∫–æ–Ω—á–∏–ª—Å—è`))}const l=setInterval(a,1e3);return q[t]={interval:l,element:o},e.activate(),!0}function st(t){switch(t){case"growthBoost":R=!1;break;case"yieldBoost":N=!1;break;case"rareHarvest":P=!1;break;case"superFood":O=!1;break}console.log(`–ë–∞—Ñ "${t}" –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω.`)}function z(t,e,n,o){if(!c[t]||c[t].count<1){u("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤!",!0);return}if(Object.keys(q).length>0){u("–ù–µ–ª—å–∑—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞—Ñ–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!",!0);return}at(n)&&(u(o),E(t,1))}function ct(t){z(t,"fertilizer","growthBoost","–£–¥–æ–±—Ä–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ! –†–∞—Å—Ç–µ–Ω–∏—è —Ä–∞—Å—Ç—É—Ç –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.")}function rt(t){z(t,"plant_food","yieldBoost","–ï–¥–∞ –¥–ª—è –∫—É—Å—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞! +1 —à–∏—à–∫–∞ –∑–∞ –∫–∞–∂–¥—ã–π —Å–±–æ—Ä.")}function lt(t){z(t,"rare_fertilizer","rareHarvest","–†–µ–¥–∫–∏–π —É–¥–æ–±—Ä–∏—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω! 50% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —à–∏—à–∫—É.")}function dt(t){z(t,"super_food","superFood","–°—É–ø–µ—Ä-–ø–∏—Ç–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ! 10% —à–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å 5 —à–∏—à–µ–∫ –≤–º–µ—Å—Ç–æ 1.")}document.addEventListener("touchstart",function(t){t.touches.length>1&&t.preventDefault()},{passive:!1});function S(){if(D){let i=function(a){o||(o=a);const l=a-o,d=Math.min(l/n,1);D.textContent=t+Math.round(e*d),l<n&&window.requestAnimationFrame(i)};const t=parseInt(D.textContent),e=b-t,n=500;let o=null;window.requestAnimationFrame(i)}}function L(){if(!_)return;_.innerHTML="";let t=0;for(const[e,n]of Object.entries(c)){if(t>=15)break;const o=document.createElement("div");o.classList.add("inventory-item"),o.dataset.itemId=e;const i=document.createElement("img");i.src=ut(e),i.alt=(n==null?void 0:n.name)||"";const a=document.createElement("div");a.classList.add("item-count"),a.textContent=typeof n=="object"&&(n!=null&&n.count)?`x${n.count}`:"x0",o.append(i,a),o.addEventListener("click",()=>pt(e,o)),_.appendChild(o),t++}for(;t<15;)_.appendChild(document.createElement("div")).classList.add("inventory-item"),t++}function ut(t){return{shishka:"bud.png",fertilizer:"fertilizer.png",zip:"zip.png",zip_shishka:"zip_shishka.png",plant_food:"plant_food.png",pot:"pot.png",booster:"booster.png",rare_fertilizer:"rare_fertilizer.png",super_food:"super_food.png"}[t]||"bud.png"}function pt(t,e){var a;const n=c[t];if(!n)return;const o=[],i={fertilizer:()=>ct(t),plant_food:()=>rt(t),rare_fertilizer:()=>lt(t),super_food:()=>dt(t)};i[n.type]&&o.push({label:"–ü—Ä–∏–º–µ–Ω–∏—Ç—å",action:i[n.type]}),t==="mixer_machine"&&o.push({label:"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å",action:()=>openMixerInterface()}),n.type==="zip"&&((a=c.shishka)==null?void 0:a.count)>=5&&o.push({label:"–†–∞—Å—Ñ–∞—Å–æ–≤–∞—Ç—å",action:()=>ht(t)},{label:"–†–∞—Å—Ñ–∞—Å–æ–≤–∞—Ç—å –≤—Å–µ",action:()=>gt(t)}),mt(o,e)}function mt(t,e){const n=document.getElementById("action-menu");if(n){if(n.innerHTML="",t.length===0){n.classList.add("hidden");return}t.forEach(o=>{const i=document.createElement("button");i.className="action-button",i.textContent=o.label,i.addEventListener("click",()=>{o.action(),K()}),n.appendChild(i)}),ft(n,e)}}function ft(t,e){const n=e.getBoundingClientRect();t.style.visibility="hidden",t.classList.remove("hidden");const o=t.getBoundingClientRect(),i=window.innerWidth,a=window.innerHeight,l={right:{left:n.right+5,top:Math.min(n.top,a-o.height-10)},left:{left:n.left-o.width-5,top:Math.min(n.top,a-o.height-10)},bottom:{left:Math.max(10,Math.min(n.left,i-o.width-10)),top:n.bottom+5}};let d=l.right;l.right.left+o.width>i&&(l.left.left>=10?d=l.left:d=l.bottom),d.left=Math.max(10,Math.min(d.left,i-o.width-10)),d.top=Math.max(10,Math.min(d.top,a-o.height-10)),t.style.cssText=`
        position: fixed;
        left: ${d.left}px;
        top: ${d.top}px;
        opacity: 1;
        transform: scale(1);
        z-index: 100000;
        visibility: visible;
    `}function K(){const t=document.getElementById("action-menu");t&&t.classList.add("hidden")}document.addEventListener("click",t=>{const e=document.getElementById("action-menu");e&&!e.contains(t.target)&&!t.target.closest(".inventory-item")&&K()});function ht(t){var e,n;((e=c.shishka)==null?void 0:e.count)>=5&&((n=c[t])==null?void 0:n.count)>=1?(E("shishka",5),E(t,1),c.zip_shishka||(c.zip_shishka={count:0,type:"packed_product",name:"Zip —Å —à–∏—à–∫–æ–π"}),c.zip_shishka.count+=1,C(),L()):u("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —à–∏—à–µ–∫ –∏–ª–∏ zip –ø–∞–∫–µ—Ç–æ–≤!",!0)}function gt(t){const e=c.shishka,n=c[t];if(!e||!n){u("–ù–µ—Ç —à–∏—à–µ–∫ –∏–ª–∏ zip –ø–∞–∫–µ—Ç–æ–≤!",!0);return}const o=Math.min(Math.floor(e.count/5),n.count);if(o===0){u("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —à–∏—à–µ–∫ –∏–ª–∏ zip –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—Ñ–∞—Å–æ–≤–∫–∏!",!0);return}E("shishka",o*5),E(t,o),c.zip_shishka||(c.zip_shishka={count:0,type:"packed_product",name:"Zip —Å —à–∏—à–∫–æ–π"}),c.zip_shishka.count+=o,C(),L(),u(`–£—Å–ø–µ—à–Ω–æ —É–ø–∞–∫–æ–≤–∞–Ω–æ ${o} –ø–∞–∫–µ—Ç–æ–≤!`)}function E(t,e){c[t]&&(c[t].count-=e,c[t].count<=0&&delete c[t],C(),L())}function C(){localStorage.setItem("inventory",JSON.stringify(c))}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("inventar_button"),e=document.getElementById("inventory-modal"),n=document.getElementById("close-inventory");_=document.querySelector(".inventory-items");const o=document.getElementById("shop_button"),i=document.getElementById("shop-modal"),a=document.getElementById("close-shop-button"),l=document.querySelector(".shop-items"),d=document.querySelectorAll(".bud");document.getElementById("darknet_button");function v(){i&&(i.classList.add("open"),r(),S())}function M(){i&&i.classList.remove("open"),S()}function r(){l&&(l.innerHTML="",J.forEach(s=>{const f=document.createElement("div");f.classList.add("shop-item"),f.dataset.itemId=s.id,f.innerHTML=`
                <div class="img-cnt"><img src="${s.image}" alt="${s.name}"></div>
                <div class="item-info">
                    <div class="item-name">${s.name}</div>
                    <div class="item-description">${s.description}</div>
                    <div class="item-price">–¶–µ–Ω–∞: ${s.price} $</div>
                </div>
                <div class="buy-conteiner">
                    <button class="buy-button">–ö—É–ø–∏—Ç—å</button>
                    <div class="quantity-controls">
                        <button class="quantity-button minus">-</button>
                        <div class="quantity">1</div>
                        <button class="quantity-button plus">+</button>
                    </div>
                </div>
            `,l.appendChild(f)}))}t&&e&&t.addEventListener("click",()=>{e.classList.add("open"),L()}),n&&e&&n.addEventListener("click",()=>e.classList.remove("open")),o&&o.addEventListener("click",v),a&&a.addEventListener("click",()=>{M();const s=document.getElementById("inventory-modal");s&&s.classList.remove("open")});function g(s){s&&(W(s),s.style.cssText="opacity: 1; transform: scale(1);",setTimeout(()=>s.classList.add("active"),50))}function h(s){var f;!((f=s==null?void 0:s.classList)!=null&&f.contains("active"))||s.classList.contains("collecting")||(s.classList.add("collecting"),W(s),setTimeout(()=>{s.classList.remove("collecting"),s.style.cssText="transform: scale(0); opacity: 0;";let x=1;N&&(x+=1),P&&Math.random()<.5&&(x+=1),O&&Math.random()<.1&&(x+=4),c.shishka||(c.shishka={count:0,type:"product",name:"–®–∏—à–∫–∞"}),c.shishka.count+=x,C(),L(),setTimeout(()=>g(s),R?1e3:5e3)},1e3))}function W(s){if(!(s!=null&&s.parentElement))return;const f=document.createElement("div");f.className="leaves";const x=s.getBoundingClientRect(),A=s.parentElement.getBoundingClientRect();f.style.cssText=`
            position: absolute;
            left: ${x.left-A.left}px;
            top: ${x.top-A.top}px;
        `;for(let U=0;U<4;U++){const B=document.createElement("div");B.className="leaf",B.style.setProperty("--x",`${Math.random()*40-20}px`),B.style.setProperty("--y",`${Math.random()*-40}px`),f.appendChild(B)}s.parentElement.appendChild(f),setTimeout(()=>f.remove(),500)}d.forEach(s=>{g(s),s.addEventListener("click",()=>h(s))}),S()});document.addEventListener("click",function(t){var e;if(t.target.classList.contains("plus")){const n=t.target.closest(".quantity-controls");if(n){const o=n.querySelector(".quantity");if(o){let i=parseInt(o.textContent)||1;o.textContent=i+1}}}if(t.target.classList.contains("minus")){const n=t.target.closest(".quantity-controls");if(n){const o=n.querySelector(".quantity");if(o){let i=parseInt(o.textContent)||1;i>1&&(o.textContent=i-1)}}}if(t.target.classList.contains("buy-button")){const n=t.target.closest(".shop-item");if(n){const o=n.dataset.itemId,i=parseInt((e=n.querySelector(".quantity"))==null?void 0:e.textContent)||1;yt(o,i,t)}}});function yt(t,e,n){const o=J.find(a=>a.id===t);if(!o)return;const i=o.price*e;if(b>=i){b-=i,c[t]||(c[t]={count:0,type:t,name:o.name}),c[t].count+=e,C(),localStorage.setItem("playerMoney",b),S(),L();let a;e===1?a=o.name.toLowerCase():a=o.displayName||`${o.name.toLowerCase()}–æ–≤`,u(`–ö—É–ø–ª–µ–Ω–æ ${e} ${a} –∑–∞ ${i}$`),n!=null&&n.target&&(n.target.textContent="–ö—É–ø–ª–µ–Ω–æ!",setTimeout(()=>{n.target&&(n.target.textContent="–ö—É–ø–∏—Ç—å")},1e3))}else u("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!",!0)}const vt=(()=>{let t={};const e={chats:{title:"–ß–∞—Ç—ã",init:o},darknet:{title:"Darknet",init:G}};function n(){t={phoneModal:document.getElementById("phone-modal"),homeScreen:document.querySelector(".home-screen"),appScreen:document.querySelector(".app-screen"),appTitle:document.querySelector(".app-title"),appContent:document.querySelector(".app-content"),closeBtn:document.querySelector(".close-phone-button"),darknetButton:document.getElementById("darknet_button")}}function o(){t.appContent&&(t.appContent.innerHTML=`
            <div class="chat-list">
                <div class="chat-item" data-contact="uncle">
                    <img src="uncle.png" alt="–î—è–¥—è –†–µ–¥–∂–∏">
                    <span>–î—è–¥—è –†–µ–¥–∂–∏</span>
                </div>
                <div class="chat-item" data-contact="sylvester">
                    <img src="sylvester.png" alt="–°–∏–ª—å–≤–µ—Å—Ç—Ä">
                    <span>–°–∏–ª—å–≤–µ—Å—Ç—Ä</span>
                </div>
            </div>
        `,setTimeout(()=>{const r=document.querySelectorAll(".chat-item");r.length&&r.forEach(g=>{g.addEventListener("click",function(){const h=this.dataset.contact;i(h)})})},0))}function i(r){t.appContent&&(t.appContent.innerHTML=`
            <div class="chat-window">
                <div class="messages"></div>
                <div class="reply-buttons"></div>
            </div>
        `,r==="uncle"?Et():r==="sylvester"&&startChatWithSylvester())}function a(r){!e[r]||!t.appTitle||!t.appContent||(t.appTitle.textContent=e[r].title,e[r].init(),t.homeScreen.style.display="none",t.appScreen.style.display="block")}function l(){!t.homeScreen||!t.appScreen||(t.homeScreen.style.display="block",t.appScreen.style.display="none")}function d(){t.phoneModal&&(t.phoneModal.style.display="flex",t.phoneModal.classList.remove("closing"),setTimeout(()=>{t.phoneModal.classList.add("open")},10),l())}function v(){t.phoneModal&&(t.phoneModal.classList.add("closing"),t.phoneModal.classList.remove("open"),setTimeout(()=>{t.phoneModal.style.display="none",t.phoneModal.classList.remove("closing")},400))}document.addEventListener("DOMContentLoaded",()=>{vt.init()}),document.querySelectorAll(".phone-app");function M(){n();const r=document.querySelector(".phone-apps");if(r&&!document.querySelector('.phone-app[data-app="darknet"]')){const h=document.createElement("div");h.className="phone-app",h.dataset.app="darknet",h.style.backgroundColor="#000",h.innerHTML=`
                <img src="darknet.png" alt="Darknet">
            `,r.appendChild(h)}t.closeBtn&&t.closeBtn.addEventListener("click",v),document.querySelectorAll(".phone-app").forEach(h=>{h.addEventListener("click",function(){a(this.dataset.app)})});const g=document.querySelector(".back-button");g&&g.addEventListener("click",l),t.darknetButton&&t.darknetButton.addEventListener("click",d)}return{init:M,open:d,close:v}})();function kt(){localStorage.setItem("darknetUnlocked","true");const t=document.querySelector(".phone-apps");if(t){const e=document.createElement("div");e.className="phone-app",e.dataset.app="darknet",e.style.backgroundColor="#000",e.innerHTML=`
            <img src="darknet.png" alt="Darknet">
        `,t.appendChild(e),e.addEventListener("click",function(){openApp("darknet")})}k("uncle","–í–æ—Ç —Ç–µ–±–µ –¥–æ—Å—Ç—É–ø –∫ Darknet Market. –ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–µ–Ω!"),k("system","Darknet Market —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∞—à–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ")}let w=parseInt(localStorage.getItem("uncleDeals"))||0;const Q=5;let H=localStorage.getItem("uncleStoppedBuying")==="true",m=parseInt(localStorage.getItem("currentDealPrice"))||0;m===0&&(m=F(),localStorage.setItem("currentDealPrice",m));const V={uncle:{start:{message:"–ù—É —á—Ç–æ, –º–µ–ª–∫–∏–π, –µ—Å—Ç—å —á–µ–º –ø–æ–¥–µ–ª–∏—Ç—å—Å—è?",replies:[{text:"–ü—Ä–æ–¥–∞—Ç—å —á–µ—Ä–µ–∑ –¥–∞—Ä–∫–Ω–µ—Ç",next:"darknet_advice"},{text:"–ü—Ä–æ–¥–∞—Ç—å —Ç–µ–±–µ",condition:()=>w<Q,next:"selling_options"},{text:"–ù–∏—á–µ–≥–æ",next:null}]},darknet_advice:{message:"Darknet - —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ, –Ω–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ. –†–∏—Å–∫ –∫–æ–Ω—Ñ–∏—Å–∫–∞—Ü–∏–∏ 30%, –Ω–æ —Ü–µ–Ω—ã –≤ 2-3 —Ä–∞–∑–∞ –≤—ã—à–µ.",replies:[{text:"–ü–æ–Ω—è–ª",next:"start"}]},selling_options:{message:`–°–∫–æ–ª—å–∫–æ —Å–∫–∏–Ω–µ—à—å? (${F()}$ –∑–∞ —É–ø–∞–∫–æ–≤–∫—É)`,replies:[{text:"–ù–µ –∂–º–æ—Ç—å, –¥–∞–≤–∞–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ",action:()=>bt()},{text:"5 —É–ø–∞–∫–æ–≤–æ–∫",condition:()=>{var t;return((t=c.zip_shishka)==null?void 0:t.count)>=5},action:()=>j(5)},{text:"–í—Å–µ —á—Ç–æ –µ—Å—Ç—å",condition:()=>{var t;return((t=c.zip_shishka)==null?void 0:t.count)>0},action:()=>j(c.zip_shishka.count)},{text:"–ü–µ—Ä–µ–¥—É–º–∞–ª",next:"start"}]},darknet_offer:{message:"–•–æ—á–µ—à—å –Ω–∞—É—á–∏—Ç—å—Å—è –ø—Ä–æ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ –¥–∞—Ä–∫–Ω–µ—Ç? –¢–∞–º —Ü–µ–Ω—ã –≤ 2 —Ä–∞–∑–∞ –≤—ã—à–µ, –Ω–æ –∏ —Ä–∏—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π.",replies:[{text:"–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ",next:"darknet_explain"},{text:"–ù–µ —Å–µ–π—á–∞—Å",next:"start"}]},darknet_explain:{message:"–¢–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è: 1) –¢–æ—Ä –±—Ä–∞—É–∑–µ—Ä 2) –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ 3) –†–µ–ø—É—Ç–∞—Ü–∏—è. –ö–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤ - –∑–∞—Ö–æ–¥–∏.",replies:[{text:"–Ø –≥–æ—Ç–æ–≤ —Å–µ–π—á–∞—Å",action:()=>kt()},{text:"–ü–æ–Ω—è–ª, –ø–æ–∑–∂–µ",next:"start"}]},darknet_explain:{message:function(){return p<5?"–¢–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è: 1) –¢–æ—Ä –±—Ä–∞—É–∑–µ—Ä 2) –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ 3) –†–µ–ø—É—Ç–∞—Ü–∏—è. –ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ.":`–¢–≤–æ—è —Ä–µ–ø—É—Ç–∞—Ü–∏—è: ${p}/10. –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!`},replies:[{text:"–ö–∞–∫ –ø–æ–≤—ã—Å–∏—Ç—å —Ä–µ–ø—É—Ç–∞—Ü–∏—é?",next:"reputation_help"},{text:"–ü–æ–Ω—è–ª, –ø–æ–∑–∂–µ",next:"start"}]},reputation_help:{message:"–†–µ–ø—É—Ç–∞—Ü–∏—è —Ä–∞—Å—Ç–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–∫–∞—Ö. –ß–µ–º –±–æ–ª—å—à–µ –ø—Ä–æ–¥–∞—à—å - —Ç–µ–º –ª—É—á—à–µ —Ü–µ–Ω—ã –∏ –Ω–∏–∂–µ —Ä–∏—Å–∫–∏.",replies:[{text:"–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–≤–µ—Ç",next:"start"}]}}};function Mt(){localStorage.setItem("uncleDeals",w),localStorage.setItem("currentDealPrice",m)}function F(){return m=Math.floor(Math.random()*16)+15,m}function Et(){if(H){k("uncle","–Ø –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫—É–ø–∞—é —Ç–æ–≤–∞—Ä. –û—Å–≤–∞–∏–≤–∞–π –¥–∞—Ä–∫–Ω–µ—Ç!"),T("uncle","darknet_offer");return}F(),T("uncle","start")}function T(t,e,n=null){const o=n||V[t][e];o&&(k(t,o.message),o.replies&&xt(o.replies))}function xt(t){const e=document.querySelector(".reply-buttons");e&&(e.innerHTML="",t.forEach(n=>{if(n.condition&&!n.condition())return;const o=document.createElement("button");o.textContent=n.text,o.addEventListener("click",()=>{k("user",n.text),e.innerHTML="",setTimeout(()=>{n.next?T("uncle",n.next):n.action&&n.action()},800)}),e.appendChild(o)}))}function j(t){if(H)return;const e=t*m;E("zip_shishka",t),b+=e,w++,localStorage.setItem("uncleDeals",w),S(),C(),u(`–ü—Ä–æ–¥–∞–Ω–æ ${t} —É–ø–∞–∫–æ–≤–æ–∫ –ø–æ ${m}$ = ${e}$`,!1),k("uncle","–î–µ–Ω—å–≥–∏ –ø–µ—Ä–µ–≤–µ–ª! –ù–µ –∑–∞–±—ã–≤–∞–π, —è –Ω–µ —Å–º–æ–≥—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ç–µ–±–µ –¥–µ–Ω—å–≥–∏, —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ä–∏—Å–∫–æ–≤!"),w>=Q&&(H=!0,localStorage.setItem("uncleStoppedBuying","true"),setTimeout(()=>{u("–î—è–¥—è –†–µ–¥–∂–∏ –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫—É–ø–∞–µ—Ç —Ç–æ–≤–∞—Ä. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞—Ä–∫–Ω–µ—Ç!",!1),k("uncle","–í—Å—ë, —Ö–≤–∞—Ç–∏—Ç! –ë–æ–ª—å—à–µ –Ω–µ –±—É–¥—É –ø–æ–∫—É–ø–∞—Ç—å."),setTimeout(()=>T("uncle","darknet_offer"),1500)},2e3))}function bt(){Math.random()>.5?(m+=5,k("uncle",`–õ–∞–¥–Ω–æ, —Å–µ–≥–æ–¥–Ω—è –¥–æ–±—Ä—ã–π - –¥–∞–º ${m}$!`)):(m=Math.max(15,m-3),k("uncle",`–ù–µ—Ç, —Ç–∞–∫ —É–∂ –∏ –±—ã—Ç—å - ${m}$ –∏ —Ç–æ—á–∫–∞!`)),document.querySelector(".reply-buttons").innerHTML="",Mt(),setTimeout(()=>{const e={message:`–ò—Ç–∞–∫, –ø–æ ${m}$ –∑–∞ —É–ø–∞–∫–æ–≤–∫—É. –°–∫–æ–ª—å–∫–æ —Å–∫–∏–Ω–µ—à—å?`,replies:V.uncle.selling_options.replies};T("uncle","selling_options",e)},1e3)}function k(t,e){const n=document.querySelector(".messages");if(!n)return;const o=document.createElement("div");o.className=`message ${t==="user"?"user":"npc"}`,o.innerHTML=`
        <div class="message-text">${e}</div>
    `,n.appendChild(o),n.scrollTop=n.scrollHeight}const y=[];function X(){const e=Math.floor(Math.random()*30),n=p*3;return Math.round(Math.min(100,50+e+n)*10)/10}let I=null;function St(){const t=document.getElementById("priceChart");t&&(I&&(I.destroy(),I=null),I=new Chart(t.getContext("2d"),{type:"line",data:{labels:y.map((e,n)=>`–¢–∏–∫ ${n+1}`),datasets:[{label:"–¶–µ–Ω–∞ –Ω–∞ —à–∏—à–∫–∏ ($)",data:y,borderColor:"limegreen",borderWidth:2,fill:!1,tension:.2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,ticks:{callback:function(e){return e+"$"}}}}}}))}function G(){var v,M;const t=Y("zip_shishka"),e=Math.round(X()*10)/10,n=Math.round(Math.max(5,30-p*2)*10)/10,o=Math.round(p*10)/10;y.push(t),y.length>10&&y.shift();const i=document.querySelector(".app-content");i.innerHTML=`
        <div class="darknet-app">
            <div class="darknet-header">
                <h2>üï∂Ô∏è DARKNET MARKET v3.2</h2>
                <p>–†–µ–ø—É—Ç–∞—Ü–∏—è: ${o}/20</p>
                <div class="darknet-rep">${nt(p)}</div>
                <div class="tor-status">${Ct()}</div>
            </div>
            
            <div class="chart-container" style="height: 200px; position: relative;">
                <canvas id="priceChart"></canvas>
            </div>

            <div class="market-item">
                <img src="${ot()}" alt="–ü–∞–∫–µ—Ç —à–∏—à–µ–∫" style="height: 60px;">
                <div class="item-name">–ü–∞–∫–µ—Ç —à–∏—à–µ–∫</div>
                <div class="item-price">–¶–µ–Ω–∞: ${t}$ (${Lt()}) [15-30$]</div>
                <div class="item-demand">–°–ø—Ä–æ—Å: ${e}%</div>
                <div class="item-risk">–†–∏—Å–∫: ${n}%</div>
                <div class="item-inventory">–£ –≤–∞—Å: ${((v=c.zip_shishka)==null?void 0:v.count)||0} —à—Ç.</div>
                <div class="quantity-selector">
                    <button id="decrease-qty">-</button>
                    <input type="text" id="sell-quantity" value="1" readonly />
                    <button id="increase-qty">+</button>
                </div>
                <button class="darknet-button" id="sell-shishka">–ü—Ä–æ–¥–∞—Ç—å</button>
            </div>
        </div>
    `,setTimeout(()=>{St()},50);let a=1;const l=((M=c.zip_shishka)==null?void 0:M.count)||0,d=document.getElementById("sell-quantity");document.getElementById("decrease-qty").addEventListener("click",()=>{a>1&&(a--,d.value=a)}),document.getElementById("increase-qty").addEventListener("click",()=>{a<l&&(a++,d.value=a)}),document.getElementById("sell-shishka").addEventListener("click",()=>{const r=a;r>0&&$t("zip_shishka",r)})}function Y(t){const e={zip_shishka:20},n=p*2,o=Math.floor(Math.random()*11)-5,i=X()/20,a=e[t]+n+o+i;return Math.round(Math.max(15,Math.min(30,a))*10)/10}function Lt(){if(y.length<2)return"‚Üî";const t=y[y.length-1],e=y[y.length-2];return t>e?"‚Üë":t<e?"‚Üì":"‚Üî"}function Ct(){const t=["TOR: Secure Connection","TOR: Relay Active","TOR: 3 Hops","TOR: Anonymous","TOR: Bridge Connected"];return t[Math.floor(Math.random()*t.length)]}function $t(t,e){if(!c[t]||c[t].count<e){u("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞!",!0);return}const n=Math.round(Y(t)*10)/10,o=Math.min(20,e*2),i=Math.round(Math.max(5,30-p*2+o)*10)/10,a=Math.round(n*e*10)/10;Math.random()*100<i?(E(t,e),u(`–ü—Ä–æ–≤–∞–ª! –¢–æ–≤–∞—Ä –∫–æ–Ω—Ñ–∏—Å–∫–æ–≤–∞–Ω –ø–æ–ª–∏—Ü–∏–µ–π. (–†–∏—Å–∫: ${i}%)`,!0),p=Math.round(Math.max(0,p-.3)*10)/10,localStorage.setItem("darknetReputation",p)):(E(t,e),b+=a,p=Math.round(Math.min(20,p+e*.2)*10)/10,localStorage.setItem("darknetReputation",p),localStorage.setItem("playerMoney",b),u(`–£—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–∞–Ω–æ ${e} —à—Ç. –∑–∞ ${a}$ (–†–∏—Å–∫: ${i}%)`),S(),G())}document.addEventListener("DOMContentLoaded",()=>{var e,n;const t=(e=window.Telegram)==null?void 0:e.WebApp;t&&(t.expand(),console.log("Telegram WebApp v"+t.version+" initialized",{platform:t.platform,viewportHeight:t.viewportHeight,user:(n=t.initDataUnsafe)==null?void 0:n.user}))});window.addEventListener("load",()=>{const t=document.getElementById("loading-screen");t&&setTimeout(()=>{t.classList.add("loaded"),setTimeout(()=>{t.remove()},500)},5e3),delete c.mixer_machine,delete c.light});document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("connectBtn"),e=document.getElementById("walletInfo"),n=new et;t.addEventListener("click",async()=>{try{const o=await n.connect();if(!o)throw new Error("Connection failed");const i=await n.getBalance();e.innerHTML=`
                <p>Connected: ${_t(o.address)}</p>
                <p>Balance: ${i} TON</p>
            `}catch(o){e.innerHTML=`
                <p style="color: red">Error: ${o.message}</p>
                <button onclick="location.reload()">Retry</button>
            `}})});function _t(t){return t?`${t.slice(0,4)}...${t.slice(-4)}`:"null"}
